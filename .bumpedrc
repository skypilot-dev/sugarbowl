files:
  - package.json
plugins:
  prerelease:
    Checking that branch is clean and releasable:
      plugin: bumped-terminal
      command:  test -z "$(git status --porcelain)" && git-branch-is -r "^develop|edge$" && yarn run all-cq-checks
    Linting config files:
      plugin: bumped-finepack
  postrelease:
    Generating CHANGELOG file:
      plugin: bumped-changelog
    Committing new version:
      plugin: bumped-terminal
      command: git add CHANGELOG.md package.json && git commit -m "Release v$newVersion"
    Publishing tag to GitHub:
      plugin: bumped-terminal
      command: git tag $newVersion && git push && git push --tags
    Publishing to NPM:
      plugin: bumped-terminal
      command: |
        DIST_TAG=$(test "$(git-branch-is --quiet master)" && echo 'latest' || echo $(git symbolic-ref --short HEAD)) \
        yarn publish --access public --new-version $newVersion --tag $DIST_TAG
